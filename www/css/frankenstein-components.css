.mission-selector{grid-column:1/-1;background:linear-gradient(135deg,rgba(139,115,85,.2) 0,rgba(74,35,90,.2) 100%),var(--paper-texture);border:4px solid var(--franken-brass);border-radius:12px;padding:1rem;box-shadow:var(--shadow-deep);position:relative;max-height:180px;overflow-y:auto;flex-shrink:0}.mission-selector::before{content:'üéØ';position:absolute;top:.5rem;right:.5rem;font-size:2rem;opacity:.15;pointer-events:none}.mission-selector-title{text-align:center;font-size:1.2rem;font-weight:700;color:var(--franken-brass);margin-bottom:.75rem;font-family:Cinzel,serif;letter-spacing:.1em}.missions-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:.75rem}.mission-card{background:linear-gradient(135deg,var(--franken-parchment) 0,#e8dcc4 100%),var(--paper-texture);border:2px solid var(--franken-copper);border-radius:8px;padding:.75rem;cursor:pointer;transition:all .3s ease;position:relative;text-align:center}.mission-card::before{content:'';position:absolute;inset:6px;border:1px solid rgba(139,115,85,.3);border-radius:6px;pointer-events:none}.mission-card:hover{transform:translateY(-5px);box-shadow:var(--shadow-deep),0 0 20px rgba(212,175,55,.3);border-color:var(--franken-brass)}.mission-card.selected{border-color:var(--franken-brass);background:linear-gradient(135deg,#fff9e6 0,#f0e5c8 100%);box-shadow:var(--glow-lightning)}.mission-icon{font-size:2rem;margin-bottom:.35rem}.mission-name{font-size:.9rem;font-weight:700;color:var(--franken-dark);margin:.35rem 0;font-family:Cinzel,serif}.mission-description{font-size:.75rem;color:var(--franken-sepia);line-height:1.3;margin-bottom:.35rem}.mission-difficulty{display:inline-block;padding:.2rem .6rem;background:var(--franken-purple);color:var(--franken-parchment);border-radius:8px;font-size:.65rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em}.change-mission-btn{margin-top:.75rem;padding:.75rem 1.5rem;background:linear-gradient(135deg,var(--franken-brass) 0,#b87333 100%);color:#1e1e2e;border:2px solid var(--franken-brass);border-radius:8px;font-weight:600;font-size:.9rem;cursor:pointer;transition:all .3s ease;font-family:Cinzel,serif;display:flex;align-items:center;justify-content:center;gap:.5rem;box-shadow:0 4px 12px rgba(212,175,55,.3)}.change-mission-btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(212,175,55,.5);background:linear-gradient(135deg,gold 0,var(--franken-brass) 100%)}.change-mission-btn:active{transform:translateY(0);box-shadow:0 2px 8px rgba(212,175,55,.3)}.mission-modal{position:fixed;inset:0;z-index:10000;display:flex;align-items:center;justify-content:center;padding:1rem;opacity:0;pointer-events:none;transition:opacity .3s ease}.mission-modal.active{opacity:1;pointer-events:all}.mission-modal-overlay{position:absolute;inset:0;background:rgba(0,0,0,.85);backdrop-filter:blur(8px)}.mission-modal-content{position:relative;background:linear-gradient(135deg,#1e1e2e 0,#2d2d44 100%);border:3px solid var(--franken-brass);border-radius:16px;max-width:900px;width:100%;max-height:85vh;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,.9);animation:modalSlideUp .4s cubic-bezier(.4,0,.2,1);display:flex;flex-direction:column}@keyframes modalSlideUp{from{opacity:0;transform:translateY(50px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.mission-modal-header{padding:1.5rem 2rem;border-bottom:2px solid rgba(212,175,55,.3);display:flex;align-items:center;justify-content:space-between;flex-shrink:0;background:linear-gradient(135deg,rgba(212,175,55,.1) 0,rgba(139,115,85,.1) 100%)}.mission-modal-title{margin:0;color:var(--franken-brass);font-family:Cinzel,serif;font-size:1.5rem;font-weight:700;letter-spacing:.1em}.mission-modal-close{background:0 0;border:none;color:var(--franken-parchment);cursor:pointer;padding:.5rem;display:flex;align-items:center;justify-content:center;border-radius:8px;transition:all .2s}.mission-modal-close:hover{background:rgba(212,175,55,.2);color:var(--franken-brass)}.mission-modal-body{padding:2rem;overflow-y:auto;flex:1}.mission-modal-body .missions-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:1.5rem}.mission-modal-body .mission-card{padding:1.25rem;min-height:200px;display:flex;flex-direction:column;align-items:center;justify-content:center}.mission-modal-body .mission-icon{font-size:3rem;margin-bottom:.75rem}.mission-modal-body .mission-name{font-size:1.1rem;margin:.5rem 0}.mission-modal-body .mission-description{font-size:.85rem;margin-bottom:.75rem;text-align:center}@media (max-width:768px){.mission-modal-content{max-height:95vh}.mission-modal-header{padding:1rem 1.5rem}.mission-modal-title{font-size:1.2rem}.mission-modal-body{padding:1.5rem}.mission-modal-body .missions-grid{grid-template-columns:1fr;gap:1rem}.change-mission-btn{font-size:.85rem;padding:.65rem 1.25rem}}.fab-container{position:fixed;bottom:2rem;right:2rem;display:flex;flex-direction:column;gap:1rem;z-index:1000}.fab{position:relative;width:64px;height:64px;border-radius:50%;border:none;background:linear-gradient(135deg,var(--franken-brass) 0,#b87333 100%);color:#1e1e2e;cursor:pointer;box-shadow:0 6px 20px rgba(212,175,55,.4),0 0 0 0 rgba(212,175,55,.4);transition:all .3s cubic-bezier(.4, 0, .2, 1);display:flex;align-items:center;justify-content:center;overflow:visible}.fab:hover{transform:translateY(-4px) scale(1.05);box-shadow:0 8px 28px rgba(212,175,55,.6),0 0 0 8px rgba(212,175,55,.1)}.fab:hover .fab-label{opacity:1;transform:translateX(0);visibility:visible}.fab:active{transform:translateY(-2px) scale(1.02)}.fab-label{position:absolute;right:76px;background:rgba(30,30,45,.95);color:var(--franken-brass);padding:.5rem 1rem;border-radius:8px;font-size:.85rem;font-weight:600;white-space:nowrap;opacity:0;transform:translateX(10px);visibility:hidden;transition:all .3s ease;pointer-events:none;border:1px solid var(--franken-brass);font-family:Cinzel,serif}.fab-badge{position:absolute;top:-4px;right:-4px;min-width:24px;height:24px;background:#ff9800;color:#fff;border-radius:12px;font-size:.7rem;font-weight:700;display:flex;align-items:center;justify-content:center;padding:0 6px;border:2px solid #1e1e2e;animation:pulse 2s infinite}@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}.fab-requirements{background:linear-gradient(135deg,#4caf50 0,#2e7d32 100%)}.fab-pieces{background:linear-gradient(135deg,#2196f3 0,#1565c0 100%)}@media (max-width:768px){.fab-container{bottom:1rem;right:1rem;gap:.75rem}.fab{width:56px;height:56px}.fab-label{display:none}.fab-badge{font-size:.65rem;min-width:20px;height:20px}}.pieces-modal,.requirements-modal{position:fixed;inset:0;z-index:10000;display:flex;align-items:center;justify-content:center;padding:1rem;opacity:0;pointer-events:none;transition:opacity .3s ease}.pieces-modal.active,.requirements-modal.active{opacity:1;pointer-events:all}.pieces-modal-overlay,.requirements-modal-overlay{position:absolute;inset:0;background:rgba(0,0,0,.85);backdrop-filter:blur(8px)}.pieces-modal-content,.requirements-modal-content{position:relative;background:linear-gradient(135deg,#1e1e2e 0,#2d2d44 100%);border:3px solid var(--franken-brass);border-radius:16px;max-width:600px;width:100%;max-height:85vh;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,.9);animation:modalSlideUp .4s cubic-bezier(.4,0,.2,1);display:flex;flex-direction:column}.pieces-modal-content{max-width:1000px}.requirements-sticky-header{position:sticky;top:0;z-index:1000;background:linear-gradient(135deg,rgba(30,30,45,.98) 0,rgba(20,20,35,.98) 100%);border-bottom:2px solid rgba(212,175,55,.4);padding:.75rem 1.5rem;display:none;align-items:center;justify-content:space-between;gap:1rem;backdrop-filter:blur(10px);box-shadow:0 4px 20px rgba(0,0,0,.4);animation:slideDown .3s ease-out}.requirements-sticky-header.visible{display:flex}.sticky-requirements-compact{display:flex;align-items:center;gap:1rem;flex:1;overflow-x:auto;scrollbar-width:none}.sticky-requirements-compact::-webkit-scrollbar{display:none}.sticky-requirement-item{display:flex;align-items:center;gap:.5rem;padding:.5rem .75rem;background:rgba(212,175,55,.1);border:1px solid rgba(212,175,55,.3);border-radius:20px;white-space:nowrap;transition:all .3s ease}.sticky-requirement-item.fulfilled{background:rgba(76,175,80,.15);border-color:rgba(76,175,80,.4)}.sticky-requirement-icon{font-size:1.2rem}.sticky-requirement-percentage{font-size:.9rem;font-weight:600;color:var(--franken-brass)}.sticky-requirement-item.fulfilled .sticky-requirement-percentage{color:#4caf50}.sticky-progress-indicator{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;background:rgba(212,175,55,.15);border-radius:20px;border:1px solid rgba(212,175,55,.3)}.sticky-progress-bar{width:120px;height:8px;background:rgba(0,0,0,.3);border-radius:4px;overflow:hidden}.sticky-progress-fill{height:100%;background:linear-gradient(90deg,#ff9800 0,#ffb74d 100%);transition:width .3s ease}.sticky-progress-fill.complete{background:linear-gradient(90deg,#4caf50 0,#66bb6a 100%)}.sticky-progress-text{font-size:.85rem;font-weight:600;color:var(--franken-brass);white-space:nowrap}.pieces-modal-header,.requirements-modal-header{padding:1.5rem 2rem;border-bottom:2px solid rgba(212,175,55,.3);display:flex;align-items:center;justify-content:space-between;flex-shrink:0;background:linear-gradient(135deg,rgba(76,175,80,.1) 0,rgba(46,125,50,.1) 100%)}.pieces-modal-header{background:linear-gradient(135deg,rgba(33,150,243,.1) 0,rgba(21,101,192,.1) 100%)}.pieces-modal-title,.requirements-modal-title{margin:0;color:var(--franken-brass);font-family:Cinzel,serif;font-size:1.5rem;font-weight:700;letter-spacing:.1em}.pieces-modal-close,.requirements-modal-close{background:0 0;border:none;color:var(--franken-parchment);cursor:pointer;padding:.5rem;display:flex;align-items:center;justify-content:center;border-radius:8px;transition:all .2s}.pieces-modal-close:hover,.requirements-modal-close:hover{background:rgba(212,175,55,.2);color:var(--franken-brass)}.pieces-modal-body,.requirements-modal-body{padding:0;overflow-y:auto;flex:1}.requirements-modal-body .requirements-panel{position:relative;border:none;border-radius:0;box-shadow:none;background:0 0;padding:1.5rem}.pieces-modal-body .pieces-grid{width:100%;padding:1.5rem;position:relative;max-width:100%}.missing-requirements-quick-view{background:linear-gradient(135deg,rgba(139,115,85,.15) 0,rgba(212,175,55,.1) 100%);border:2px solid rgba(212,175,55,.3);border-radius:12px;margin:1.5rem;padding:1.25rem;animation:slideDown .3s ease-out}.quick-view-header{display:flex;align-items:center;gap:.75rem;margin-bottom:1rem;padding-bottom:.75rem;border-bottom:1px solid rgba(212,175,55,.3)}.quick-view-icon{font-size:1.5rem}.quick-view-title{flex:1;margin:0;color:var(--franken-brass);font-family:Cinzel,serif;font-size:1.1rem;font-weight:600;letter-spacing:.05em}.quick-view-status{font-weight:700;font-size:1rem;padding:.25rem .75rem;background:rgba(0,0,0,.2);border-radius:12px;color:var(--franken-brass)}.quick-view-list{display:flex;flex-direction:column;gap:.75rem}.quick-view-item{display:flex;align-items:center;gap:.75rem;padding:.75rem;background:rgba(0,0,0,.2);border:1px solid rgba(212,175,55,.2);border-radius:8px;transition:all .2s ease}.quick-view-item:hover{background:rgba(212,175,55,.15);border-color:rgba(212,175,55,.4);transform:translateX(4px)}.quick-view-item-icon{font-size:1.5rem;min-width:32px;text-align:center}.quick-view-item-content{flex:1;display:flex;flex-direction:column;gap:.25rem}.quick-view-item-text{color:var(--franken-brass);font-size:.9rem;font-weight:600}.quick-view-item-count{color:var(--franken-brass);font-size:.8rem;font-weight:600}.quick-view-filter-btn{background:rgba(212,175,55,.2);border:1px solid rgba(212,175,55,.3);border-radius:6px;padding:.5rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s ease;color:var(--franken-brass)}.quick-view-filter-btn:hover{background:rgba(212,175,55,.3);border-color:rgba(212,175,55,.5);transform:scale(1.1)}.quick-view-filter-btn svg{width:16px;height:16px}.quick-view-complete{display:flex;align-items:center;justify-content:center;gap:.75rem;padding:1.5rem;background:linear-gradient(135deg,rgba(76,175,80,.2) 0,rgba(46,125,50,.2) 100%);border:2px solid #4caf50;border-radius:8px}.complete-icon{font-size:2rem;animation:bounce 1s ease infinite}@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}.complete-text{color:#4caf50;font-weight:700;font-size:1rem;font-family:Cinzel,serif}.quick-view-no-mission{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1rem;padding:2rem;text-align:center}.no-mission-icon{font-size:3rem;opacity:.5}.no-mission-text{color:var(--franken-brass);font-weight:600;font-size:1rem;font-family:Cinzel,serif}.no-mission-btn{background:linear-gradient(135deg,var(--franken-brass) 0,#b87333 100%);color:#1e1e2e;border:none;padding:.75rem 1.5rem;border-radius:8px;font-weight:600;font-size:.9rem;cursor:pointer;transition:all .2s;font-family:Cinzel,serif}.no-mission-btn:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(212,175,55,.4)}@media (max-width:768px){.missing-requirements-quick-view{margin:1rem;padding:1rem}.quick-view-title{font-size:1rem}.quick-view-item{padding:.65rem}.quick-view-item-icon{font-size:1.25rem;min-width:28px}.quick-view-item-text{font-size:.85rem}.quick-view-item-count{font-size:.75rem}.quick-view-filter-btn{padding:.4rem}.complete-icon{font-size:1.5rem}.complete-text{font-size:.9rem}}@media (max-width:768px){.pieces-modal-content,.requirements-modal-content{max-height:95vh;max-width:100%}.pieces-modal-header,.requirements-modal-header{padding:1rem 1.5rem}.pieces-modal-title,.requirements-modal-title{font-size:1.2rem}.requirements-modal-body .requirements-panel{padding:1rem}.pieces-modal-body .bottom-sheet-content{padding:1rem}}.being-display{grid-column:1;background:0 0;border:4px solid var(--franken-copper);border-radius:12px;padding:1rem;box-shadow:var(--shadow-deep);position:relative;display:flex;flex-direction:column;min-height:0;overflow-y:auto}.being-display::before{content:'';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:min(400px,80%);height:min(400px,80%);border:2px dashed var(--franken-copper);border-radius:50%;opacity:.3;pointer-events:none}.being-display::after{content:'';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:min(280px,56%);height:min(280px,56%);border:2px dashed var(--franken-brass);opacity:.2;pointer-events:none}.being-attributes::before{content:'‚äï';position:absolute;top:-.5rem;left:50%;transform:translateX(-50%);font-size:1rem;color:var(--franken-brass);opacity:.4;z-index:1}.being-balance::before{content:'~';position:absolute;left:-.5rem;top:50%;transform:translateY(-50%) rotate(-90deg);font-size:1.5rem;color:var(--franken-copper);opacity:.3}.being-balance::after{content:'~';position:absolute;right:-.5rem;top:50%;transform:translateY(-50%) rotate(90deg);font-size:1.5rem;color:var(--franken-copper);opacity:.3}.being-info{text-align:center;margin-bottom:.75rem;padding:.75rem;background:linear-gradient(135deg,rgba(139,115,85,.2) 0,rgba(74,35,90,.1) 100%);border:2px solid var(--franken-copper);border-radius:8px;position:relative;z-index:2;flex-shrink:0}.being-info::before{content:'‚à¥';position:absolute;top:.5rem;left:50%;transform:translateX(-50%);font-size:1.5rem;color:var(--franken-brass);opacity:.5}.being-name{font-size:1.4rem;font-weight:700;color:var(--franken-brass);margin:0;font-family:Cinzel,serif;text-shadow:0 2px 4px rgba(0,0,0,.5)}.being-mission{font-size:.9rem;color:var(--franken-parchment);margin-top:.25rem;font-style:italic;font-family:'Crimson Text',serif}.being-attributes{display:none;margin-bottom:1rem;position:relative;z-index:2}.attributes-title{font-size:1.2rem;font-weight:700;color:var(--franken-brass);margin-bottom:1rem;text-align:center;font-family:Cinzel,serif;text-transform:uppercase;letter-spacing:.15em;position:relative}.attributes-title::after,.attributes-title::before{content:'‚öõ';position:absolute;top:50%;transform:translateY(-50%);font-size:1rem;color:var(--franken-brass);opacity:.5}.attributes-title::before{left:0}.attributes-title::after{right:0}.attributes-bars{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:.5rem;max-height:400px;overflow-y:auto;padding-right:.5rem}.attribute-bar{background:linear-gradient(90deg,rgba(139,115,85,.15) 0,rgba(139,115,85,.05) 100%),var(--paper-texture);border:1px solid var(--franken-copper);border-left:3px solid var(--franken-copper);border-radius:4px;padding:.5rem;transition:all .3s ease;position:relative}.attribute-bar::before{content:'';position:absolute;left:-3px;top:0;bottom:0;width:3px;background:linear-gradient(180deg,var(--franken-brass) 0,var(--franken-copper) 100%);opacity:0;transition:opacity .3s ease}.attribute-bar:hover::before{opacity:1}.attribute-bar[data-status=met]{border-left-color:var(--franken-brass);background:linear-gradient(90deg,rgba(212,175,55,.2) 0,rgba(212,175,55,.05) 100%),var(--paper-texture);box-shadow:0 0 10px rgba(212,175,55,.2)}.attribute-label{display:flex;align-items:center;gap:.5rem;margin-bottom:.25rem}.attribute-icon{font-size:1.2rem}.attribute-name{flex:1;font-weight:600;color:var(--franken-parchment)}.attribute-value{font-weight:700;color:var(--franken-brass);font-family:monospace}.attribute-progress{width:100%;height:8px;background:rgba(10,10,15,.5);border-radius:4px;overflow:hidden}.attribute-fill{height:100%;transition:width .5s ease;border-radius:4px}.being-balance{display:none;margin-bottom:1.5rem;padding:1rem;background:rgba(139,115,85,.1);border:2px solid var(--franken-copper);border-radius:8px}.balance-title{font-size:1.2rem;font-weight:700;color:var(--franken-brass);margin-bottom:1rem;text-align:center;font-family:Cinzel,serif}.balance-categories{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:.75rem;margin-bottom:1rem}.balance-item{display:flex;flex-direction:column;align-items:center;gap:.25rem}.balance-label{font-size:.85rem;color:var(--franken-sepia)}.balance-value{font-size:1.5rem;font-weight:700;color:var(--franken-brass);font-family:monospace}.balance-harmony{display:flex;align-items:center;gap:1rem;margin-bottom:.5rem;color:var(--franken-parchment)}.harmony-bar{flex:1;height:12px;background:rgba(10,10,15,.5);border-radius:6px;overflow:hidden}.harmony-fill{height:100%;background:linear-gradient(90deg,#ef4444 0,#f59e0b 50%,#10b981 100%);transition:width .5s ease;border-radius:6px}.balance-total{text-align:center;font-size:1.1rem;font-weight:700;color:var(--franken-brass);margin:.5rem 0 0 0}.pieces-deck{grid-column:2;background:linear-gradient(135deg,rgba(139,115,85,.2) 0,rgba(74,35,90,.2) 100%),var(--paper-texture);border:4px solid var(--franken-copper);border-radius:12px;padding:1.5rem;box-shadow:var(--shadow-deep);position:relative;display:flex;flex-direction:column;min-height:0;overflow-y:auto}.pieces-deck::before{content:'üß™';position:absolute;top:.5rem;right:.5rem;font-size:2rem;opacity:.15;pointer-events:none}.pieces-deck::after{content:'‚öóÔ∏è';position:absolute;bottom:.5rem;left:.5rem;font-size:2rem;opacity:.15;pointer-events:none}.pieces-filters{display:flex;gap:.5rem;margin-bottom:1rem;flex-wrap:wrap;justify-content:space-between;align-items:center;flex-shrink:0}.filter-buttons-group{display:flex;gap:.5rem;flex-wrap:wrap}.scoring-legend{display:flex;gap:1rem;align-items:center;padding:.5rem 1rem;background:linear-gradient(135deg,rgba(139,115,85,.3) 0,rgba(74,35,90,.2) 100%);border:2px solid var(--franken-copper);border-radius:8px;font-size:.8rem}.scoring-item{display:flex;align-items:center;gap:.25rem;color:var(--franken-parchment)}.scoring-icon{font-size:1rem}.scoring-label{font-weight:600}.scoring-value{color:var(--franken-brass);font-weight:700;font-family:monospace}.filter-btn{padding:.5rem 1rem;background:rgba(139,115,85,.3);border:2px solid var(--franken-copper);border-radius:8px;color:var(--franken-parchment);font-weight:600;cursor:pointer;transition:all .3s ease;font-family:'Crimson Text',serif}.filter-btn:hover{background:rgba(184,115,51,.5);border-color:var(--franken-brass)}.filter-btn.active{background:var(--franken-brass);color:var(--franken-dark);box-shadow:0 0 15px rgba(212,175,55,.5)}.pieces-grid{display:flex;flex-direction:column;gap:.75rem;transition:all .3s ease;position:relative;width:100%}.pieces-grid.has-expanded-book{position:fixed;top:0;left:0;right:0;bottom:0;z-index:9999;background:rgba(10,10,20,.95);display:flex;flex-direction:column;padding:0;margin:0;gap:0}body.book-expanded .requirements-sticky-header.visible{position:fixed;top:0;left:0;right:0;z-index:10002;display:flex;margin:0;border-radius:0}.book-tree-item{width:100%;background:linear-gradient(145deg,rgba(30,30,45,.95) 0,rgba(20,20,35,.98) 100%);border:2px solid rgba(212,175,55,.3);border-radius:16px;overflow:visible;box-shadow:0 8px 32px rgba(0,0,0,.4),inset 0 1px 0 rgba(255,255,255,.1);position:relative;animation:page-turn .6s ease-out;animation-fill-mode:both;flex-shrink:0;backdrop-filter:blur(10px);transition:all .4s cubic-bezier(.4, 0, .2, 1)}.book-tree-item.expanded{position:absolute;top:0;left:0;right:0;bottom:0;margin:0;display:flex;flex-direction:column;background:linear-gradient(145deg,rgba(20,20,35,.98) 0,rgba(15,15,25,.99) 100%);height:100vh;width:100%;z-index:10000;padding-top:80px}.book-tree-item.expanded .book-tree-content{flex:1;overflow-y:auto;overflow-x:hidden;padding:1rem;padding-bottom:2rem;max-height:none!important;display:block!important}.book-tree-item.expanded .book-chapters{display:flex;flex-direction:column;gap:.5rem;padding:0 1rem}.pieces-grid.has-expanded-book .book-tree-item:not(.expanded){display:none}body.book-expanded .missing-requirements-quick-view{display:none!important}.book-tree-item.expanded .book-tree-header{position:relative;z-index:1;background:linear-gradient(135deg,rgba(30,30,45,.98) 0,rgba(20,20,35,.98) 100%);backdrop-filter:blur(10px);border-bottom:2px solid rgba(212,175,55,.3);padding:1rem 1.5rem;cursor:pointer;flex-shrink:0}.book-tree-item.expanded .book-tree-header:hover{background:linear-gradient(135deg,rgba(40,40,55,.98) 0,rgba(30,30,45,.98) 100%)}.book-tree-item.expanded .book-tree-toggle{font-size:1.5rem;transform:rotate(90deg)}.book-tree-item.expanded .book-tree-toggle::before{content:'‚úï';position:absolute;font-size:1.8rem;color:var(--franken-brass);animation:pulse 2s ease-in-out infinite}.book-tree-item.expanded .book-tree-toggle{position:relative;color:transparent}.book-tree-item:not(.expanded):hover{transform:translateY(-4px);border-color:rgba(212,175,55,.6);box-shadow:0 12px 48px rgba(0,0,0,.5),0 0 40px rgba(212,175,55,.2),inset 0 1px 0 rgba(255,255,255,.15)}.book-tree-item::before{content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,transparent,var(--franken-brass),transparent);border-radius:16px 16px 0 0;opacity:0;transition:opacity .3s ease}.book-tree-item:hover::before{opacity:1}.book-tree-header{display:grid;grid-template-columns:auto 1fr auto;align-items:center;gap:1rem;padding:1.25rem 1.5rem;min-height:80px;cursor:pointer;transition:all .3s ease;background:rgba(255,255,255,.02);border-bottom:1px solid rgba(212,175,55,.1);position:relative;z-index:1}.book-tree-header:hover{background:rgba(255,255,255,.05)}.book-tree-header.open{background:linear-gradient(90deg,rgba(212,175,55,.15) 0,rgba(212,175,55,.05) 100%);border-bottom-color:rgba(212,175,55,.4)}.book-tree-toggle{font-size:1rem;color:var(--franken-brass);transition:transform .3s ease;font-weight:700}.book-tree-toggle.open{transform:rotate(90deg)}.book-tree-icon{font-size:2.5rem;width:56px;height:56px;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,rgba(212,175,55,.2) 0,rgba(139,115,85,.2) 100%);border-radius:12px;border:2px solid rgba(212,175,55,.3);filter:drop-shadow(0 4px 8px rgba(0, 0, 0, .3));transition:all .3s ease}.book-tree-header:hover .book-tree-icon{transform:scale(1.1) rotate(5deg);border-color:rgba(212,175,55,.6);box-shadow:0 0 20px rgba(212,175,55,.4)}.book-tree-title{display:flex;flex-direction:column;gap:.5rem;min-width:0}.book-tree-title-text{font-weight:700;font-size:1.1rem;color:var(--franken-brass);font-family:Cinzel,serif;line-height:1.3;text-shadow:0 2px 4px rgba(0,0,0,.5);letter-spacing:.5px}.book-tree-subtitle{font-size:.85rem;color:rgba(244,233,216,.7);font-weight:400;font-family:'Crimson Text',serif}.book-tree-stats,.chapter-tree-stats{display:flex;flex-direction:column;align-items:flex-end;gap:.5rem;flex-shrink:0}.book-tree-count,.chapter-tree-count{display:flex;align-items:center;gap:.5rem;background:rgba(212,175,55,.15);color:var(--franken-brass);padding:.4rem .9rem;border-radius:20px;font-size:.9rem;font-weight:600;border:1px solid rgba(212,175,55,.3);backdrop-filter:blur(10px);transition:all .3s ease}.book-tree-count:hover,.chapter-tree-count:hover{background:rgba(212,175,55,.25);border-color:rgba(212,175,55,.5);transform:translateX(-4px)}.book-tree-power,.chapter-tree-power{display:flex;align-items:center;gap:.5rem;background:linear-gradient(135deg,rgba(255,215,0,.2) 0,rgba(255,237,78,.2) 100%);color:gold;padding:.4rem .9rem;border-radius:20px;font-size:.95rem;font-weight:700;border:1px solid rgba(255,215,0,.3);box-shadow:0 0 20px rgba(255,215,0,.2);backdrop-filter:blur(10px);animation:pulse-glow 2s ease-in-out infinite;transition:all .3s ease}.book-tree-power:hover,.chapter-tree-power:hover{background:linear-gradient(135deg,rgba(255,215,0,.3) 0,rgba(255,237,78,.3) 100%);box-shadow:0 0 30px rgba(255,215,0,.4);transform:translateX(-4px)}.book-tree-attributes,.chapter-tree-attributes{display:flex;flex-wrap:wrap;gap:.6rem;padding:1rem 1.5rem 1.25rem 1.5rem;background:rgba(0,0,0,.2);border-top:1px solid rgba(212,175,55,.1)}.tree-attribute{display:inline-flex;align-items:center;gap:.4rem;padding:.5rem .9rem;background:rgba(212,175,55,.1);border:1px solid rgba(212,175,55,.25);border-radius:20px;font-size:.85rem;font-weight:600;color:var(--franken-brass);backdrop-filter:blur(10px);transition:all .3s cubic-bezier(.4, 0, .2, 1)}.tree-attribute:hover{background:rgba(212,175,55,.2);border-color:rgba(212,175,55,.5);transform:translateY(-2px) scale(1.05);box-shadow:0 4px 12px rgba(212,175,55,.3)}.book-tree-content{max-height:0;overflow:hidden;transition:max-height .4s ease-out}.book-tree-content.open{max-height:400px;overflow-y:auto;overflow-x:hidden;transition:max-height .4s ease-in;scroll-behavior:smooth}.book-chapters{padding:.5rem;display:flex;flex-direction:column;gap:.5rem}.chapter-tree-item{background:linear-gradient(135deg,rgba(255,255,255,.03) 0,rgba(255,255,255,.01) 100%);border-left:3px solid rgba(212,175,55,.4);border-radius:12px;overflow:visible;margin-left:.5rem;margin-bottom:.75rem;box-shadow:0 4px 12px rgba(0,0,0,.2);position:relative;transition:all .3s cubic-bezier(.4, 0, .2, 1)}.chapter-tree-item:hover{transform:translateX(4px);border-left-color:var(--franken-brass);box-shadow:0 6px 20px rgba(0,0,0,.3);background:linear-gradient(135deg,rgba(255,255,255,.05) 0,rgba(255,255,255,.02) 100%)}.chapter-tree-item::before{content:'';position:absolute;left:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,var(--franken-brass) 0,var(--franken-copper) 100%);opacity:0;transition:opacity .3s ease}.chapter-tree-item:hover::before{opacity:1}.chapter-tree-header{display:flex;align-items:center;gap:.5rem;padding:.75rem;cursor:pointer;transition:all .2s ease}.chapter-tree-header:hover{background:rgba(184,115,51,.2)}.chapter-tree-header.open{background:rgba(212,175,55,.2);border-bottom:1px solid var(--franken-copper)}.chapter-tree-toggle{font-size:.8rem;color:var(--franken-brass);transition:transform .3s ease}.chapter-tree-toggle.open{transform:rotate(90deg)}.chapter-tree-icon{font-size:1.2rem}.chapter-tree-title{flex:1;font-weight:600;font-size:.95rem;color:var(--franken-parchment);white-space:normal;word-break:break-word;line-height:1.4;min-width:0}.chapter-tree-content{max-height:0;overflow:hidden;transition:max-height .3s ease-out}.chapter-tree-content.open{max-height:2000px;overflow-y:auto;overflow-x:hidden;transition:max-height .4s ease-in;scroll-behavior:smooth}.book-tree-item.expanded .chapter-tree-content.open{max-height:none}.chapter-pieces{padding:.5rem;display:flex;flex-direction:column;gap:.25rem;margin-left:1rem}.piece-card{background:linear-gradient(135deg,rgba(244,233,216,.95) 0,rgba(232,220,196,.98) 100%);border:2px solid rgba(139,115,85,.3);border-radius:12px;padding:1rem 1.25rem;min-height:70px;cursor:pointer;transition:all .4s cubic-bezier(.4, 0, .2, 1);position:relative;display:flex;align-items:center;gap:1rem;box-shadow:0 4px 12px rgba(0,0,0,.15),inset 0 1px 0 rgba(255,255,255,.5);margin-bottom:.75rem;overflow:hidden}.piece-card::before{content:'';position:absolute;left:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,var(--franken-brass) 0,var(--franken-copper) 100%);opacity:0;transition:opacity .3s ease}.piece-card:hover::before{opacity:1}.piece-card::after{content:'‚ö°';position:absolute;top:.25rem;right:.25rem;font-size:.75rem;opacity:.15;pointer-events:none}.piece-card:hover{transform:translateY(-4px) translateX(4px);box-shadow:0 8px 24px rgba(0,0,0,.25),0 0 30px rgba(212,175,55,.3),inset 0 1px 0 rgba(255,255,255,.7);border-color:var(--franken-brass);z-index:10}.piece-card.selected{border-color:var(--franken-brass);border-width:3px;background:linear-gradient(135deg,rgba(255,249,230,.98) 0,#f0e5c8 100%);box-shadow:0 8px 24px rgba(212,175,55,.4),0 0 40px rgba(212,175,55,.3),inset 0 1px 0 rgba(255,255,255,.8),inset 0 0 30px rgba(212,175,55,.1);transform:scale(1.02)}.piece-card.selected::before{content:'‚úì';position:absolute;top:-12px;right:-12px;width:44px;height:44px;background:linear-gradient(135deg,var(--franken-brass) 0,var(--franken-copper) 100%);border-radius:50%;border:3px solid rgba(30,30,45,.9);display:flex;align-items:center;justify-content:center;color:var(--franken-dark);font-weight:900;font-size:1.4rem;box-shadow:0 6px 20px rgba(0,0,0,.5),0 0 30px rgba(212,175,55,.7),inset 0 2px 6px rgba(255,255,255,.4);z-index:10;animation:stamp-appear .5s cubic-bezier(.68,-.55,.265,1.55)}@keyframes stamp-appear{0%{transform:scale(0) rotate(-180deg);opacity:0}70%{transform:scale(1.2) rotate(10deg)}100%{transform:scale(1) rotate(0);opacity:1}}.piece-header{display:flex;align-items:center;gap:.5rem;flex-shrink:0}.piece-icon{font-size:1.5rem;flex-shrink:0}.piece-type-badge{padding:.25rem .5rem;background:var(--franken-purple);color:var(--franken-parchment);border-radius:8px;font-size:.65rem;font-weight:600;text-transform:uppercase;flex-shrink:0}.piece-multiplier-badge{padding:.25rem .5rem;border-radius:6px;font-size:.7rem;font-weight:700;flex-shrink:0;box-shadow:0 2px 4px rgba(0,0,0,.2);animation:pulse-glow 2s ease-in-out infinite}.piece-multiplier-badge.common{background:linear-gradient(135deg,#10b981 0,#059669 100%);color:#fff}.piece-multiplier-badge.rare{background:linear-gradient(135deg,#fbbf24 0,#f59e0b 100%);color:#1a1a1a}.piece-multiplier-badge.legendary{background:linear-gradient(135deg,#a78bfa 0,#8b5cf6 100%);color:#fff;text-shadow:0 1px 2px rgba(0,0,0,.3)}@keyframes pulse-glow{0%,100%{box-shadow:0 2px 4px rgba(0,0,0,.2)}50%{box-shadow:0 2px 8px rgba(212,175,55,.4)}}.piece-title{font-size:.95rem;font-weight:600;color:var(--franken-dark);line-height:1.4;flex:1;word-wrap:break-word;overflow-wrap:break-word}.piece-book{display:none}.piece-attributes-preview{display:flex;gap:.25rem;flex-wrap:wrap;align-items:center}.piece-attribute{display:inline-flex;align-items:center;gap:.15rem;padding:.15rem .4rem;background:linear-gradient(135deg,rgba(139,115,85,.3) 0,rgba(74,35,90,.2) 100%);border:1px solid rgba(139,115,85,.4);border-radius:6px;font-size:.75rem;font-weight:600;color:var(--franken-parchment);cursor:help;transition:all .2s ease}.piece-attribute:hover{background:linear-gradient(135deg,rgba(139,115,85,.5) 0,rgba(74,35,90,.4) 100%);border-color:var(--franken-copper);transform:translateY(-1px)}.piece-power{font-size:.8rem;font-weight:700;color:var(--franken-brass);margin-left:auto;flex-shrink:0}.validation-results{background:rgba(10,10,15,.8);border:3px solid var(--franken-brass);border-radius:12px;padding:1.5rem;margin-top:1.5rem;box-shadow:var(--shadow-deep)}.validation-header{text-align:center;padding:1rem;border-radius:8px;margin-bottom:1rem}.validation-header.viable{background:linear-gradient(135deg,rgba(16,185,129,.3) 0,rgba(5,150,105,.3) 100%);border:2px solid #10b981}.validation-header.not-viable{background:linear-gradient(135deg,rgba(239,68,68,.3) 0,rgba(220,38,38,.3) 100%);border:2px solid #ef4444}.validation-header h3{font-size:1.8rem;font-weight:700;margin:0 0 .5rem 0;font-family:Cinzel,serif}.validation-score{font-size:1.2rem;font-weight:600;color:var(--franken-brass)}.validation-section{margin:1rem 0;padding:1rem;background:rgba(139,115,85,.1);border-left:4px solid var(--franken-copper);border-radius:4px}.validation-section h4{font-size:1.1rem;font-weight:700;color:var(--franken-brass);margin:0 0 .5rem 0;font-family:Cinzel,serif}.validation-section ul{margin:0;padding-left:1.5rem;color:var(--franken-parchment)}.validation-section li{margin:.5rem 0;line-height:1.4}.validation-message{text-align:center;font-size:1.1rem;font-weight:600;padding:1rem;border-radius:8px;margin:1rem 0}.validation-message.success{background:rgba(16,185,129,.2);color:#6ee7b7;border:2px solid #10b981}@keyframes pulse-glow{0%,100%{box-shadow:0 0 10px rgba(212,175,55,.5)}50%{box-shadow:0 0 25px rgba(212,175,55,.8),0 0 40px rgba(212,175,55,.4)}}.pulse-glow{animation:pulse-glow 2s ease-in-out infinite}@media (max-width:480px){.mission-modal-content{width:100%;max-width:100%;margin:0;border-radius:16px 16px 0 0;position:fixed;bottom:0;left:0;right:0;max-height:90dvh;max-height:90vh}.mission-modal-header{padding:.75rem 1rem}.mission-modal-title{font-size:1rem}.mission-modal-body{padding:.75rem;max-height:70dvh;max-height:70vh;overflow-y:auto}.mission-modal-body .missions-grid{grid-template-columns:1fr;gap:.5rem}.mission-modal-body .mission-card{padding:.75rem}.pieces-modal-content,.requirements-modal-content{width:100%;max-width:100%;margin:0;border-radius:16px 16px 0 0;position:fixed;bottom:0;left:0;right:0;max-height:85dvh;max-height:85vh}.franken-modal-actions,.modal-actions{flex-direction:column;gap:.5rem}.franken-modal-actions button,.modal-actions button{width:100%;min-height:44px}}@media (max-height:500px) and (orientation:landscape){.mission-modal-content,.pieces-modal-content,.requirements-modal-content{max-height:95vh;overflow-y:auto}.mission-modal-header{padding:.5rem 1rem}.mission-modal-body{max-height:60vh;padding:.5rem 1rem}.mission-modal-body .mission-icon{display:none}.mission-modal-body .missions-grid{grid-template-columns:repeat(2,1fr)}}@supports (padding:max(0px)){.mission-modal-content,.pieces-modal-content,.requirements-modal-content{padding-bottom:max(1rem,env(safe-area-inset-bottom));padding-left:max(1rem,env(safe-area-inset-left));padding-right:max(1rem,env(safe-area-inset-right))}.mission-modal-overlay,.pieces-modal-overlay,.requirements-modal-overlay{padding-bottom:env(safe-area-inset-bottom)}}