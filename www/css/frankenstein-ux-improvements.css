:root{--z-base:1;--z-dropdown:100;--z-sticky:200;--z-fixed:300;--z-fab:400;--z-modal-backdrop:500;--z-modal:600;--z-popover:700;--z-tooltip:800;--z-toast:900;--z-critical:9999;--bp-mobile:480px;--bp-tablet:768px;--bp-desktop:1024px;--bp-wide:1280px;--safe-area-top:env(safe-area-inset-top, 0px);--safe-area-bottom:env(safe-area-inset-bottom, 0px);--safe-area-left:env(safe-area-inset-left, 0px);--safe-area-right:env(safe-area-inset-right, 0px);--ease-out-expo:cubic-bezier(0.16, 1, 0.3, 1);--ease-out-back:cubic-bezier(0.34, 1.56, 0.64, 1);--ease-in-out-circ:cubic-bezier(0.85, 0, 0.15, 1);--spring:cubic-bezier(0.22, 1, 0.36, 1);--toast-success:#10b981;--toast-error:#ef4444;--toast-warning:#f59e0b;--toast-info:#3b82f6}.toast-container{position:fixed;bottom:calc(var(--safe-area-bottom,0px) + 80px);right:1rem;left:1rem;display:flex;flex-direction:column-reverse;gap:.625rem;z-index:var(--z-toast);pointer-events:none;max-width:400px;margin-left:auto}@media (min-width:769px){.toast-container{left:auto;right:1.5rem;bottom:1.5rem}}.toast{pointer-events:auto;display:flex;align-items:flex-start;gap:.75rem;padding:1rem 1.25rem;border-radius:12px;background:rgba(30,30,46,.95);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border:1px solid rgba(255,255,255,.1);box-shadow:0 8px 32px rgba(0,0,0,.4),0 0 0 1px rgba(255,255,255,.05) inset;color:#f4f4f5;font-size:.9375rem;line-height:1.4;transform:translateX(120%);opacity:0;animation:toast-slide-in .5s var(--spring) forwards;position:relative;overflow:hidden}.toast.exiting{animation:toast-slide-out .35s var(--ease-out-expo) forwards}@keyframes toast-slide-in{0%{transform:translateX(120%);opacity:0}100%{transform:translateX(0);opacity:1}}@keyframes toast-slide-out{0%{transform:translateX(0);opacity:1}100%{transform:translateX(120%);opacity:0}}.toast-icon{width:24px;height:24px;flex-shrink:0;display:flex;align-items:center;justify-content:center;border-radius:50%;font-size:14px}.toast-content{flex:1;min-width:0}.toast-title{font-weight:600;margin-bottom:.25rem}.toast-message{opacity:.9;font-size:.875rem}.toast-close{width:28px;height:28px;border-radius:6px;background:rgba(255,255,255,.1);border:none;color:inherit;cursor:pointer;display:flex;align-items:center;justify-content:center;opacity:.7;transition:all .2s ease;flex-shrink:0}.toast-close:hover{opacity:1;background:rgba(255,255,255,.2)}.toast-progress{position:absolute;bottom:0;left:0;height:3px;background:currentColor;opacity:.5;animation:toast-progress linear forwards}@keyframes toast-progress{from{width:100%}to{width:0%}}.toast.success{border-color:rgba(16,185,129,.4)}.toast.success .toast-icon{background:rgba(16,185,129,.2);color:var(--toast-success)}.toast.success .toast-progress{background:var(--toast-success)}.toast.error{border-color:rgba(239,68,68,.4)}.toast.error .toast-icon{background:rgba(239,68,68,.2);color:var(--toast-error)}.toast.error .toast-progress{background:var(--toast-error)}.toast.warning{border-color:rgba(245,158,11,.4)}.toast.warning .toast-icon{background:rgba(245,158,11,.2);color:var(--toast-warning)}.toast.warning .toast-progress{background:var(--toast-warning)}.toast.info{border-color:rgba(59,130,246,.4)}.toast.info .toast-icon{background:rgba(59,130,246,.2);color:var(--toast-info)}.toast.info .toast-progress{background:var(--toast-info)}.toast.critical{border-width:2px;animation:toast-slide-in .5s var(--spring) forwards,toast-shake .5s ease-in-out .5s}.toast.critical .toast-progress{display:none}@keyframes toast-shake{0%,100%{transform:translateX(0)}20%,60%{transform:translateX(-6px)}40%,80%{transform:translateX(6px)}}.toast-action{margin-top:.5rem}.toast-action-btn{padding:.375rem .75rem;border-radius:6px;background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.2);color:inherit;font-size:.8125rem;font-weight:500;cursor:pointer;transition:all .2s ease}.toast-action-btn:hover{background:rgba(255,255,255,.25)}.mission-modal-overlay,.modal-overlay-enhanced{background:rgba(0,0,0,.6);backdrop-filter:blur(0px);-webkit-backdrop-filter:blur(0px);transition:backdrop-filter .4s var(--ease-out-expo),background .3s ease}.mission-modal.active .mission-modal-overlay,.modal-enhanced.active .modal-overlay-enhanced{backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);background:rgba(0,0,0,.75)}.mission-modal-content,.modal-content-enhanced{transform:translateY(40px) scale(.92);opacity:0;transition:transform .45s var(--spring),opacity .35s ease}.mission-modal.active .mission-modal-content,.modal-enhanced.active .modal-content-enhanced{transform:translateY(0) scale(1);opacity:1}.mission-modal.closing .mission-modal-content,.modal-enhanced.closing .modal-content-enhanced{transform:translateY(20px) scale(.95);opacity:0;transition-duration:.25s}.modal-drag-handle{width:40px;height:5px;background:rgba(255,255,255,.25);border-radius:3px;margin:.875rem auto;cursor:grab;transition:all .2s ease}.modal-drag-handle:hover{background:rgba(255,255,255,.4);width:50px}.modal-drag-handle:active{cursor:grabbing;background:rgba(255,255,255,.5);transform:scaleY(.8)}.modal-header-enhanced{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.25rem;border-bottom:1px solid rgba(255,255,255,.1);position:sticky;top:0;background:inherit;z-index:10}.modal-close-btn{width:36px;height:36px;border-radius:10px;background:rgba(255,255,255,.1);border:none;color:inherit;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s ease}.modal-close-btn:hover{background:rgba(239,68,68,.3);transform:rotate(90deg)}.modal-close-btn:active{transform:rotate(90deg) scale(.9)}.fab-container{z-index:var(--z-fab)!important;bottom:calc(var(--safe-area-bottom,0px) + 1.5rem);right:1.5rem}.fab{position:relative;transition:transform .25s var(--spring),box-shadow .25s ease,background .2s ease}.fab:hover{transform:scale(1.08)}.fab:active{transform:scale(.95);transition-duration:.1s}.fab::after{content:'';position:absolute;inset:0;border-radius:inherit;background:radial-gradient(circle,rgba(255,255,255,.3) 0,transparent 70%);opacity:0;transform:scale(0);transition:transform .4s ease,opacity .4s ease}.fab:active::after{opacity:1;transform:scale(2);transition-duration:0s}@media (max-width:768px){.fab-container{bottom:calc(var(--safe-area-bottom,0px) + 1rem);right:1rem;gap:.75rem}.fab.fab-primary{width:auto!important;min-width:56px;height:56px;border-radius:16px!important;padding:0 1.25rem;display:flex!important;align-items:center;gap:.625rem}.fab.fab-primary .fab-label{display:block!important;opacity:1!important;visibility:visible!important;position:static!important;transform:none!important;font-size:.9375rem;font-weight:600;white-space:nowrap;background:0 0!important;padding:0!important;color:inherit}.fab:not(.fab-primary){width:48px!important;height:48px!important}.fab:not(.fab-primary) .fab-label{display:none!important}.fab-tooltip-touch{position:absolute;right:calc(100% + 12px);top:50%;transform:translateY(-50%);background:rgba(30,30,46,.95);backdrop-filter:blur(8px);padding:.5rem .875rem;border-radius:8px;font-size:.8125rem;font-weight:500;white-space:nowrap;opacity:0;pointer-events:none;transition:opacity .2s ease;box-shadow:0 4px 12px rgba(0,0,0,.3);border:1px solid rgba(255,255,255,.1)}.fab-tooltip-touch::after{content:'';position:absolute;right:-6px;top:50%;transform:translateY(-50%);border:6px solid transparent;border-left-color:rgba(30,30,46,.95)}.fab.show-tooltip .fab-tooltip-touch{opacity:1}}.fab-badge{position:absolute;top:-4px;right:-4px;min-width:20px;height:20px;padding:0 6px;border-radius:10px;background:var(--toast-error);color:#fff;font-size:.6875rem;font-weight:700;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px rgba(239,68,68,.4);animation:badge-pop .3s var(--ease-out-back)}.fab-badge:empty,.fab-badge[data-count="0"]{display:none}@keyframes badge-pop{0%{transform:scale(0)}100%{transform:scale(1)}}.bottom-sheet-enhanced{position:fixed;bottom:0;left:0;right:0;background:linear-gradient(180deg,#1e1e2e 0,#252536 100%);border-radius:24px 24px 0 0;box-shadow:0 -8px 32px rgba(0,0,0,.4);z-index:var(--z-modal);transform:translateY(100%);transition:transform .4s var(--spring);max-height:90vh;overflow:hidden;display:flex;flex-direction:column}.bottom-sheet-enhanced.open{transform:translateY(0)}.bottom-sheet-enhanced[data-snap=peek]{transform:translateY(calc(100% - 120px))}.bottom-sheet-enhanced[data-snap=half]{transform:translateY(50%)}.bottom-sheet-enhanced[data-snap=full]{transform:translateY(0)}.bottom-sheet-handle{padding:1rem;cursor:grab;touch-action:none;display:flex;flex-direction:column;align-items:center;gap:.5rem}.bottom-sheet-handle:active{cursor:grabbing}.bottom-sheet-handle-bar{width:40px;height:5px;background:rgba(255,255,255,.3);border-radius:3px;transition:all .2s ease}.bottom-sheet-enhanced.dragging .bottom-sheet-handle-bar{width:60px;background:rgba(255,255,255,.5)}.bottom-sheet-scroll-hint{position:absolute;bottom:100%;left:50%;transform:translateX(-50%);padding:.375rem .75rem;background:rgba(0,0,0,.6);border-radius:12px 12px 0 0;font-size:.75rem;color:rgba(255,255,255,.7);opacity:0;transition:opacity .2s}.bottom-sheet-enhanced:not([data-snap=full]) .bottom-sheet-scroll-hint{opacity:1}.bottom-sheet-content{flex:1;overflow-y:auto;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.mission-card{transition:transform .25s var(--spring),box-shadow .25s ease,border-color .2s ease;will-change:transform}.mission-card:hover{transform:translateY(-6px) scale(1.02);box-shadow:0 16px 32px rgba(0,0,0,.25),0 0 0 1px rgba(212,175,55,.3)}.mission-card:active{transform:translateY(-2px) scale(.98);transition-duration:.1s}.mission-card.selected{animation:card-selected-glow 2.5s ease-in-out infinite}@keyframes card-selected-glow{0%,100%{box-shadow:0 0 20px rgba(212,175,55,.35),0 8px 24px rgba(0,0,0,.2),inset 0 0 20px rgba(212,175,55,.08)}50%{box-shadow:0 0 35px rgba(212,175,55,.5),0 8px 24px rgba(0,0,0,.2),inset 0 0 30px rgba(212,175,55,.15)}}.piece-card{position:relative;transition:transform .2s var(--spring),box-shadow .2s ease}.piece-card::before{content:'';position:absolute;top:0;left:0;right:0;height:4px;border-radius:8px 8px 0 0;opacity:.8;transition:opacity .2s}.piece-card:hover::before{opacity:1}.piece-card.piece-type-chapter::before,.piece-card[data-type=chapter]::before{background:linear-gradient(90deg,#3b82f6 0,#6366f1 100%)}.piece-card.piece-type-exercise::before,.piece-card[data-type=exercise]::before{background:linear-gradient(90deg,#10b981 0,#14b8a6 100%)}.piece-card.piece-type-resource::before,.piece-card[data-type=resource]::before{background:linear-gradient(90deg,#f59e0b 0,#ef4444 100%)}.piece-card:hover{transform:translateY(-4px);box-shadow:0 12px 24px rgba(0,0,0,.2)}.piece-card.selected{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,0,0,.15),0 0 0 2px rgba(212,175,55,.6)}.piece-card.selected::after{content:'';position:absolute;top:8px;right:8px;width:24px;height:24px;background:var(--franken-brass);border-radius:50%;display:flex;align-items:center;justify-content:center;animation:checkmark-pop .3s var(--ease-out-back)}@keyframes checkmark-pop{0%{transform:scale(0) rotate(-45deg)}100%{transform:scale(1) rotate(0)}}.smart-tooltip{position:fixed;z-index:var(--z-tooltip);max-width:280px;padding:.75rem 1rem;background:rgba(20,20,30,.98);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,.15);border-radius:10px;box-shadow:0 8px 32px rgba(0,0,0,.4);color:#f4f4f5;font-size:.875rem;line-height:1.5;pointer-events:none;opacity:0;transform:translateY(4px);transition:opacity .2s ease,transform .2s ease}.smart-tooltip.visible{opacity:1;transform:translateY(0)}.smart-tooltip::before{content:'';position:absolute;width:10px;height:10px;background:inherit;border:inherit;border-right:none;border-bottom:none;transform:rotate(45deg)}.smart-tooltip.position-top::before{bottom:-6px;left:50%;margin-left:-5px;transform:rotate(-135deg)}.smart-tooltip.position-bottom::before{top:-6px;left:50%;margin-left:-5px;transform:rotate(45deg)}.smart-tooltip.position-left::before{right:-6px;top:50%;margin-top:-5px;transform:rotate(135deg)}.smart-tooltip.position-right::before{left:-6px;top:50%;margin-top:-5px;transform:rotate(-45deg)}.smart-tooltip-title{font-weight:600;margin-bottom:.375rem;color:var(--franken-brass)}.smart-tooltip.tooltip-attribute{display:flex;align-items:flex-start;gap:.75rem}.smart-tooltip-icon{width:32px;height:32px;border-radius:8px;background:rgba(212,175,55,.2);display:flex;align-items:center;justify-content:center;font-size:1.25rem;flex-shrink:0}.smart-tooltip-value{font-size:1.125rem;font-weight:700;color:var(--franken-brass)}.skeleton{background:linear-gradient(90deg,rgba(255,255,255,.04) 0,rgba(255,255,255,.08) 50%,rgba(255,255,255,.04) 100%);background-size:200% 100%;animation:skeleton-shimmer 1.5s ease-in-out infinite;border-radius:4px}@keyframes skeleton-shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}.mission-card.loading,.piece-card.loading{pointer-events:none}.mission-card.loading *,.piece-card.loading *{color:transparent!important;background:0 0!important}.mission-card.loading::after,.piece-card.loading::after{content:'';position:absolute;inset:0;background:linear-gradient(90deg,rgba(255,255,255,.03) 0,rgba(255,255,255,.08) 50%,rgba(255,255,255,.03) 100%);background-size:200% 100%;animation:skeleton-shimmer 1.5s ease-in-out infinite;border-radius:inherit}.skeleton-text{height:1em;margin-bottom:.5em;border-radius:4px}.skeleton-text:last-child{width:70%}.skeleton-avatar{width:48px;height:48px;border-radius:50%}.btn-loading,.lab-button.loading{position:relative;color:transparent!important;pointer-events:none}.btn-loading::after,.lab-button.loading::after{content:'';position:absolute;top:50%;left:50%;width:20px;height:20px;margin:-10px 0 0 -10px;border:2px solid transparent;border-top-color:currentColor;border-right-color:currentColor;border-radius:50%;animation:spinner .7s linear infinite}@keyframes spinner{to{transform:rotate(360deg)}}.loading-overlay{position:absolute;inset:0;background:rgba(30,30,46,.8);backdrop-filter:blur(4px);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1rem;z-index:100;opacity:0;pointer-events:none;transition:opacity .3s ease}.loading-overlay.active{opacity:1;pointer-events:auto}.loading-spinner-large{width:48px;height:48px;border:3px solid rgba(212,175,55,.2);border-top-color:var(--franken-brass);border-radius:50%;animation:spinner .8s linear infinite}.loading-text{color:rgba(255,255,255,.7);font-size:.875rem}.empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem 2rem;text-align:center}.empty-state-icon{width:80px;height:80px;margin-bottom:1.5rem;opacity:.4;font-size:3rem}.empty-state-title{font-size:1.25rem;font-weight:600;color:rgba(255,255,255,.9);margin-bottom:.5rem}.empty-state-description{font-size:.9375rem;color:rgba(255,255,255,.6);max-width:300px;margin-bottom:1.5rem;line-height:1.5}.empty-state-action{padding:.75rem 1.5rem;background:linear-gradient(135deg,var(--franken-brass) 0,#b87333 100%);color:#1e1e2e;border:none;border-radius:10px;font-weight:600;cursor:pointer;transition:all .2s ease}.empty-state-action:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(212,175,55,.3)}.validation-success{animation:validation-success-pulse .6s ease-out}@keyframes validation-success-pulse{0%{box-shadow:0 0 0 0 rgba(16,185,129,.6)}100%{box-shadow:0 0 0 20px rgba(16,185,129,0)}}.validation-error{animation:validation-error-shake .5s ease-out}@keyframes validation-error-shake{0%,100%{transform:translateX(0)}20%,60%{transform:translateX(-8px)}40%,80%{transform:translateX(8px)}}.progress-bar-enhanced{height:8px;background:rgba(255,255,255,.1);border-radius:4px;overflow:hidden;position:relative}.progress-bar-fill{height:100%;background:linear-gradient(90deg,var(--franken-brass),gold);border-radius:4px;transition:width .5s var(--ease-out-expo);position:relative}.progress-bar-fill::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(90deg,transparent 0,rgba(255,255,255,.3) 50%,transparent 100%);animation:progress-shine 2s ease-in-out infinite}@keyframes progress-shine{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}.animated-counter{display:inline-block;transition:transform .3s var(--ease-out-back)}.animated-counter.updating{transform:scale(1.2)}:focus-visible{outline:2px solid var(--franken-brass);outline-offset:2px}.fab:focus-visible,.lab-button:focus-visible,.mission-card:focus-visible,.piece-card:focus-visible{outline:3px solid var(--franken-brass);outline-offset:3px}@media (prefers-reduced-motion:reduce){*,::after,::before{animation-duration:0s!important;animation-iteration-count:1!important;transition-duration:0s!important}.toast{transform:none!important;animation:none!important}.skeleton{animation:none;background:rgba(255,255,255,.08)}}@media (prefers-contrast:high){.toast{border-width:2px}.mission-card,.piece-card{border-width:2px}.fab{border:2px solid currentColor}}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}[aria-live=assertive],[aria-live=polite]{position:absolute;left:-10000px;width:1px;height:1px;overflow:hidden}